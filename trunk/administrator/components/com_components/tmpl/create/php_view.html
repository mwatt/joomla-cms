<pat:comment>
@version $Id: php_view.html 137 2005-09-12 10:21:17Z eddieajau $
@package Mambo
@copyright Copyright (C) 2005 Open Source Matters. All rights reserved.
@license http://www.gnu.org/copyleft/gpl.html GNU/GPL
</pat:comment>
	/**
	 * {BASENAME} list
	 */
	function view() {
		global $database, $option, $mainframe, $_LANG;

		// form data
		$limit 			= $mainframe->getUserStateFromRequest( 'viewlistlimit', 'limit', $GLOBALS['mosConfig_list_limit'] );
		$limitstart 	= $mainframe->getUserStateFromRequest( "view{$option}limitstart", 'limitstart', 0 );

		// search filter
		$search 		= $mainframe->getUserStateFromRequest( "search{$option}", 'search', '' );
		$search 		= trim( strtolower( $search ) );

		// column ordering
		$orderCol	= mosGetParam( $_REQUEST, 'orderCol' );
		$orderDirn	= mosGetParam( $_REQUEST, 'orderDirn', 0 );
		if ( empty( $orderCol ) ) {
			$orderCol = 'ordering';
		}

		// data lists
		$lists = array();

		// prime template variables
		$vars = array(
			'orderCol' 	=> $orderCol,
			'orderDirn' => $orderDirn,
			'search'	=> $search,
		);

		$rows = array();
		$query = 'SELECT a.*, co.name AS editor' .
			' FROM #__{BASENAME} AS a' .
			' LEFT JOIN #__users AS co ON co.id=a.checked_out' .
			' WHERE a.title LIKE ' . $database->Quote( '%' . $search . '%' ) .
			' ORDER BY ' . $database->getEscaped( $orderCol ) . ' ' . ($orderDirn ? 'DESC' : 'ASC')
			;

		$database->setQuery( $query, $limitstart, $limit );
		$rows = $database->loadObjectList();

		mosFS::load( '@pageNavigationAdmin' );

		$total = count( $rows );
		$pageNav = new mosPageNav( $total, $limitstart, $limit );

		mosFS::load( '@admin_html' );
		{BASENAME}Screens::view( $rows, $vars, $lists, $pageNav );
	}