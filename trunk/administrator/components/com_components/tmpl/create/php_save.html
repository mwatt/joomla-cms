<pat:comment>
@version $Id: php_save.html 137 2005-09-12 10:21:17Z eddieajau $
@package Mambo
@copyright Copyright (C) 2005 Open Source Matters. All rights reserved.
@license http://www.gnu.org/copyleft/gpl.html GNU/GPL
</pat:comment>
	/**
	 * Saves an object after an edit form submit
	 */
	function save() {
		global $database, $_LANG;

/*
		$params = mosGetParam( $_POST, 'params', '' );
		if (is_array( $params )) {
			$txt = array();
			foreach ($params as $k=>$v) {
				$txt[] = "$k=$v";
			}

	 		$_POST['params'] = mosParameters::textareaHandling( $txt );
		}
*/
		$row = new {CLASSNAME}( $database );

		if (!$row->bind( $_POST )) {
			mosErrorAlert( $row->getError() );
		}
		if (!$row->check()) {
			mosErrorAlert( $row->getError() );
		}
		if (!$row->store()) {
			mosErrorAlert( $row->getError() );
		}
		$row->checkin();

		$row->updateOrder();

		switch ($this->getTask()) {
			case 'apply':
				$msg = $_LANG->_( 'Changes saved' ) .': '. $row->title;
				mosRedirect( 'index2.php?option=com_{BASENAME}&task=edit&cid='. $row->id, $msg );

			case 'save':
			default:
				$msg = $_LANG->_( 'Saved' ) .': '. $row->title;
				mosRedirect( 'index2.php?option=com_{BASENAME}', $msg );
				break;
		}
	}